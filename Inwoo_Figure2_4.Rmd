---
title: S610 Final Project
subtitle: "S610_Project_1st_Week"
date: "2024-11-12"
author:
  name: Inwoo Lee
  affiliation: Department of Political Science
output: 
  html_document:
    latex_engine: xelatex
    keep_tex: false
    theme: journal
    highlight: kate
    toc: yes
    toc_depth: 4
    toc_float: yes
#  pdf_document:
 #   latex_engine: xelatex
#    toc: true
#    dev: cairo_pdf
always_allow_html: true
urlcolor: blue
# mainfont: cochineal
# sansfont: Fira Sans
# monofont: Fira Code
---

<style>

body {
  font-family: 'Times New Roman', Times, serif; /* Example of changing the font for the entire document */
  font-size: 16px; /* Adjust the font size if needed */
  color: black; /* Ensures the body text is black */
}

p {
  text-align: justify;
  text-indent: 2em;
  color: black; /* Ensures paragraph text is black */
}

</style>

```{r, message = FALSE}
library(tidyverse)
library(git2r) # cloning github
library(dplyr)
library(stringr)
library(igraph)
library(ggraph)
library(tidygraph)
library(ggplot2)
library(gridExtra)
```

### 1. Figure 2. Distribution of inward and outward citations in the precedent network.


```{r, echo = FALSE}
allcite_path <- "C:\\Users\\yonwo\\OneDrive\\바탕 화면\\PH.D\\course work\\3rd Semester\\Intro to Statistical Computing\\Final Project\\Judicial\\allcites.txt"
judicial_path <- "C:\\Users\\yonwo\\OneDrive\\바탕 화면\\PH.D\\course work\\3rd Semester\\Intro to Statistical Computing\\Final Project\\Judicial\\judicial.csv"
indeg_path <- "C:\\Users\\yonwo\\OneDrive\\바탕 화면\\PH.D\\course work\\3rd Semester\\Intro to Statistical Computing\\Final Project\\Judicial\\indegmat.txt"
outdeg_path <- "C:\\Users\\yonwo\\OneDrive\\바탕 화면\\PH.D\\course work\\3rd Semester\\Intro to Statistical Computing\\Final Project\\Judicial\\outdegmat.txt"

allcite <- read.csv(allcite_path, header = FALSE, sep = " ")
judicial <- read.csv(judicial_path, header = TRUE, sep = ",")
indeg <- read.csv(indeg_path, header = TRUE, sep = ",")
outdeg <- read.csv(outdeg_path, header = TRUE, sep = ",")
```

```{r, echo = FALSE}
# colnames(indeg) <- gsub("^X", "", colnames(indeg))
# indeg
```


<b>Indegree Plot</b>

```{r, echo = FALSE}
# head(allcite)
```

```{r, echo = FALSE}
# head(judicial)
```

```{r, echo = FALSE}
# head(indeg)
```

```{r, echo = FALSE}
# head(outdeg)
```


```{r}
indeg_count <- judicial %>% 
  filter(indeg > 0) %>% 
  count(indeg)
```

```{r}
indeg_plot <- ggplot(indeg_count, aes(indeg, n)) +
  geom_point(shape = 1) +
  scale_x_log10() +
  scale_y_log10() +
  labs(x = "Inward Citations",
       y = "Number of Cases") +
  theme_classic()
```
```{r}
print(indeg_plot)
```

___

<b>Outdegree Plot</b>

```{r}
outdeg_count <- judicial %>% 
  filter(outdeg > 0) %>% 
  count(outdeg)
```

```{r}
outdeg_plot <- ggplot(outdeg_count, aes(outdeg, n)) +
  geom_point(shape = 1) +
  scale_x_log10() +
  scale_y_log10() +
  labs(x = "Outward Citations",
       y = "Number of Cases") +
  theme_classic()
```
```{r}
print(outdeg_plot)
```

### 2. Figure 3. Mean inward and outward citations by year.

<b>Average Inward Citations by Year</b>

```{r}
mean_inward <- judicial %>% 
  select(caseid, year, indeg, outdeg) %>% 
  group_by(year) %>% 
  summarize(
    total_indeg = sum(indeg, na.rm = TRUE),
    case_count = n(),
    mean_indeg = total_indeg/case_count
  )

mean_inward[41:46,]
```


```{r}
ggplot(mean_inward, aes(year, mean_indeg)) +
  geom_point(shape = 1) +
  labs(y = "Inward Citations") +
  theme_classic()
```

___

<b>Average Outward Citations by Year</b>

```{r}
mean_outward <- judicial %>% 
  select(caseid, year, indeg, outdeg) %>% 
  group_by(year) %>% 
  summarize(
    total_outdeg = sum(outdeg, na.rm = TRUE),
    case_count = n(),
    mean_outdeg = total_outdeg/case_count
  )

mean_outward[80:85,]
```

```{r}
ggplot(mean_outward, aes(year, mean_outdeg)) +
  geom_point(shape = 1) +
  labs(y = "Outward Citations") + 
  theme_classic()
```

### 3. Figure 4. Percentage of cases with at least one outward citation by year.

```{r}
cases_with_min_1outward <- judicial %>% 
  select(caseid, year, indeg, outdeg) %>% 
  group_by(year) %>% 
  summarize(
    case_count = n(),
    case_count_min1outward = sum(outdeg >= 1, na.rm = TRUE),
    percentage_min1outward = case_count_min1outward/case_count
  )

cases_with_min_1outward[41:46,]
```

```{r}
ggplot(cases_with_min_1outward, aes(year, percentage_min1outward)) +
  geom_point(shape = 1) +
  labs(y = "Cases With At Least One Outward Citation (%)") +
  theme_classic()
```







